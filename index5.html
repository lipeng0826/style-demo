<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editable Div with Non-editable Span</title>
    <style>
      .non-editable {
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        padding: 2px 4px;
      }
    </style>
  </head>
  <body>
    <div id="editableDiv" contenteditable="true">
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
      Some editable text
      <span contenteditable="false" class="non-editable">
        <span contenteditable="true">Non-editable text</span>
      </span>
      more editable text.
    </div>

    <script>
      document
        .getElementById("editableDiv")
        .addEventListener("keydown", function (event) {
          if (event.key === "Backspace") {
            console.log(111);
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
              const range = selection.getRangeAt(0);
              console.log("ðŸš€ ~ document.getElementById ~ range:", range);
              if (
                range.startOffset === 0 &&
                range.startContainer.previousSibling
              ) {
                const previousNode = range.startContainer.previousSibling;
                if (
                  previousNode.nodeType === Node.ELEMENT_NODE &&
                  previousNode.classList.contains("non-editable")
                ) {
                  event.preventDefault(); // Prevent the default backspace action
                  previousNode.remove(); // Remove the non-editable span
                }
              }
            }
          }
        });
    </script>
  </body>
</html>
